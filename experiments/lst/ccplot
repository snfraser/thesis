#!/bin/csh

# setup simulation name
if (${#argv} < 1) then
    echo "No bleeding name supplied"
    exit 1
endif

set SIM = $1
set simlog = sim_${SIM}.log
 
echo "Extract from $simlog "

#ng cav tt xt

gnuplot << EOF
set output "${SIM}_xt.eps"
set term postscript enhanced color
set title "Total nightly execution time for sim: $SIM "
set xlabel "Time"
set ylabel "Execution time [hrs]"
set xdata time
set timefmt "%Y-%m-%d %H:%M:%S"
set format x "%b"
plot "${SIM}_xt.dat" using 1:3 with line ti "Time used", \
     "n2008.dat" using 1:3 with line ti "Night hours", \
     "n2008.dat" using 1:5 with line ti "Dark hours", \
     "n2008.dat" using 1:6 with line ti "Moon+dark", \
     "n2008.dat" using 1:7 with line ti "Moon+astro"
EOF

gnuplot -persist << EOF
set title "Number of groups executed per night for sim: $SIM "
set xlabel "Time"
set ylabel "Number of groups"
set xdata time
set timefmt "%Y-%m-%d %H:%M:%S"
set format x "%b"
plot "${SIM}_ng.dat" using 1:3 with line
EOF

gnuplot -persist << EOF
set title "Contention per night for sim: $SIM "
set xlabel "Time"
set ylabel "Contention"
set xdata time
set timefmt "%Y-%m-%d %H:%M:%S"
set format x "%b"
plot "${SIM}_tt.dat" using 1:3 with line ti "Contention", \
     "${SIM}_cav.dat" using 1:3 with line ti "Night average"
EOF
